<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="tailwind.js"></script>
<!-- 
  <link rel="stylesheet" href="style.css" /> -->
  <link href="https://cdn.jsdelivr.net/npm/seg-fluent-icons@latest/css/icons.min.css" rel="stylesheet"/>

  <!-- Firebase SDKs now deferred -->
  <script defer src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script defer src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

</head>
  <body>
  <div class="h-screen flex items-start justify-center" style="margin: 30px; ">
  <form id="AutoInfoForm" class="w-full max-w-lg">
  <h1 class="text-4xl font-bold text-gray-100 -mx-3 mb-6 flex items-start justify-center">Auto Information</h1>
  <div class="flex flex-wrap -mx-3 mb-6">

    <!-- 
    potentsl feature inprovement
    <div class="w-full px-3 mb-6">
      <label class="block uppercase tracking-wide text-gray-700 text-xs font-bold mb-2" for="grid-first-name">
        First Name
      </label>
      <input class="appearance-none block w-full bg-gray-200 text-gray-700 border border-red-500 rounded py-3 px-4 mb-3 leading-tight focus:outline-none focus:bg-white" id="grid-first-name" type="text" placeholder="Jane">
      <p class="text-red-500 text-xs italic">Please fill out this field.</p>
    </div> -->

    <div class="w-full px-3 mb-6">
      <label class="block uppercase tracking-wide text-white text-xs font-bold mb-2" for="teamName">
        Team Name
      </label>
      <input class="appearance-none block w-full bg-gray-800 text-gray-100 border-gray-800 rounded py-3 px-4 leading-tight focus:outline-none focus:border-purple-500 focus:border-2 border-2 rounded-lg shadow-lg" name="teamName" id="teamName" type="text" placeholder="Dragons">
    </div>

    <div class="w-full px-3 mb-6">
      <label class="block uppercase tracking-wide text-white text-xs font-bold mb-2" for="teamNumber">
        Team Number
      </label>
      <input class="appearance-none block w-full bg-gray-800 text-gray-100 border-gray-800 rounded py-3 px-4 leading-tight focus:outline-none focus:border-purple-500 focus:border-2 border-2 rounded-lg shadow-lg" name="teamNumber" id="teamNumber" type="number" placeholder="10523">
    </div>

    <div class="w-full px-3 mb-6">
      <label class="block uppercase tracking-wide text-white text-xs font-bold mb-2" for="scoringType">
        What is your prefered scoring method?
      </label>
      <div class="relative">
        <select class="appearance-none block w-full bg-gray-800 text-gray-100 border-gray-800 rounded py-3 px-4 leading-tight focus:outline-none focus:border-purple-500 focus:border-2 border-2 rounded-lg shadow-lg" name="scoringType" id="scoringType" placeholder="none">
          <option>None/push bot</option>
          <option>Specimen</option>
          <option>Samples</option>
          <option>ether, we are good at both</option>
        </select>
        <div class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700">
          <svg class="fill-white h-4 w-4" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M9.293 12.95l.707.707L15.657 8l-1.414-1.414L10 10.828 5.757 6.586 4.343 8z"/></svg>
        </div>
      </div>
    </div>

    <div class="w-full px-3 mb-6">
      <label class="block uppercase tracking-wide text-white text-xs font-bold mb-2" for="notesOnScoring">
        Notes on Scoring style
      </label>
      <input class="appearance-none block w-full bg-gray-800 text-gray-100 border-gray-800 rounded py-3 px-4 leading-tight focus:outline-none focus:border-purple-500 focus:border-2 border-2 rounded-lg shadow-lg" name="notesOnScoring" id="notesOnScoring" type="text" placeholder="Scoring Notes">
    </div>

    <div class="w-full px-3 mb-6">
      <label class="block uppercase tracking-wide text-white text-xs font-bold mb-2" for="samples">
        Cyle time for samples
      </label>
      <input class="appearance-none block w-full bg-gray-800 text-gray-100 border-gray-800 rounded py-3 px-4 leading-tight focus:outline-none focus:border-purple-500 focus:border-2 border-2 rounded-lg shadow-lg" name="samples" id="samples" type="text" placeholder="Sample Cycle time">
    </div>

     <div class="w-full px-3 mb-6">
      <label class="block uppercase tracking-wide text-white text-xs font-bold mb-2" for="Specimen">
        Cyle time for Specimen
      </label>
      <input class="appearance-none block w-full bg-gray-800 text-gray-100 border-gray-800 rounded py-3 px-4 leading-tight focus:outline-none focus:border-purple-500 focus:border-2 border-2 rounded-lg shadow-lg" name="Specimen" id="Specimen" type="text" placeholder="Specimen cycle time">
    </div>

    <div class="w-full px-3 mb-6">
      <label class="block uppercase tracking-wide text-white text-xs font-bold mb-2" for="preformance">
        How did you preform at the last competition in auto?
      </label>
      <input class="appearance-none block w-full bg-gray-800 text-gray-100 border-gray-800 rounded py-3 px-4 leading-tight focus:outline-none focus:border-purple-500 focus:border-2 border-2 rounded-lg shadow-lg" name="performance" id="performance" type="text" placeholder="Robot Go BURRRRR">
    </div>

    <div class="w-full px-3 mb-6">
      <label class="block uppercase tracking-wide text-white text-xs font-bold mb-2" for="accuracy">
        Auto Accuracy
      </label>
      <input class="appearance-none block w-full bg-gray-800 text-gray-100 border-gray-800 rounded py-3 px-4 leading-tight focus:outline-none focus:border-purple-500 focus:border-2 border-2 rounded-lg shadow-lg" name="accuracy" id="accuracy" type="text" placeholder="Good">
    </div>

    <div class="w-full px-3 mb-6">
      <label class="block uppercase tracking-wide text-white text-xs font-bold mb-2" for="failures">
        Problems with Auto
      </label>
      <input class="appearance-none block w-full bg-gray-800 text-gray-100 border-gray-800 rounded py-3 px-4 leading-tight focus:outline-none focus:border-purple-500 focus:border-2 border-2 rounded-lg shadow-lg" name="failures" id="failures" type="text" placeholder="if you have no problems you did not try">
    </div>

    <!-- diffrent auto drawing pad maddness -->
    <div>stufff here coming SOON!</div>
    <!-- end auto drawing pad maddness -->

    <div class="w-full px-3 mb-6">
      <label class="block uppercase tracking-wide text-white text-xs font-bold mb-2" for="speed">
        How fast does your Robot travel in auto?
      </label>
      <input class="appearance-none block w-full bg-gray-800 text-gray-100 border-gray-800 rounded py-3 px-4 leading-tight focus:outline-none focus:border-purple-500 focus:border-2 border-2 rounded-lg shadow-lg" name="speed" id="speed" type="text" placeholder="Speed I am Speed">
    </div>

    <div class="w-full px-3 mb-6">
      <label class="block uppercase tracking-wide text-white text-xs font-bold mb-2" for="acceleration">
        How fast does your Robot accelerate in auto?
      </label>
      <input class="appearance-none block w-full bg-gray-800 text-gray-100 border-gray-800 rounded py-3 px-4 leading-tight focus:outline-none focus:border-purple-500 focus:border-2 border-2 rounded-lg shadow-lg" name="acceleration" id="acceleration" type="text" placeholder="0 to 60 in 3.5">
    </div>

    <div class="w-full px-3 mb-6">
      <label class="block uppercase tracking-wide text-white text-xs font-bold mb-2" for="notes">
        Notes on Auto
      </label>
      <input class="appearance-none block w-full bg-gray-800 text-gray-100 border-gray-800 rounded py-3 px-4 leading-tight focus:outline-none focus:border-purple-500 focus:border-2 border-2 rounded-lg shadow-lg" name="notes" id="notes" type="text" placeholder="Robot is Awsome">
    </div>
    <div class="w-full flex space-x-8 items-start justify-center">
      <button type="button" id="clearButton" class="w-60 text-white font-bold py-4 rounded-lg bg-gradient-to-r from-red-700 to-red-500 hover:opacity-85 space-x-4">
        Clear
      </button>

      <button type="submit" id="submit" class="w-60 text-white font-bold py-4 rounded-lg bg-gradient-to-r from-green-600 to-green-400 hover:opacity-85 ">
        Submit
      </button>
    </div>
  </div>
  </form>
</div>
</body>
<style>
 body {
    background: linear-gradient(to bottom, #501DAF, #000240);
    background-repeat: no-repeat;
    background-size: 100% 100%;
    min-height: 1500px;
  }
  
</style>
<script>
    // is all modules loaded up?
    document.addEventListener("DOMContentLoaded", () => {

      // SECRETS SECTION

        // requires that the .env file is loaded
        require('dotenv').config();

        // FIREBASE CONFIG & INIT
        const firebaseConfig = {
          apiKey: process.env.FIREBASE_API_KEY,
          authDomain: process.env.FIREBASE_AUTH_DOMAIN,
          projectId: process.env.FIREBASE_PROJECT_ID,
          storageBucket: process.env.fIREBASE_STORAGE_BUCKET,
          messagingSenderId: process.env.FIREBASE_MESSAGING_SENDER_ID,
          appId: process.env.FIREBASE_APP_ID,
          measurementId: process.env.FIREBASE_MEASUREMENT_ID
        };

        // CLOUDINARY CONFIG
        const CLOUDINARY_CLOUD_NAME = process.env.CLOUDINARY_CLOUD_NAME;
        const CLOUDINARY_UPLOAD_PRESET = process.env.CLOUDINARY_UPLOAD_PRESET;

      // END OF SECRETS SECTION

      firebase.initializeApp(firebaseConfig);
      const db = firebase.firestore();

      // OFFLINE SYNC
      async function syncOfflineData() {
        const forms = JSON.parse(localStorage.getItem("unsyncedForms") || "[]");
        if (!forms.length) return;

        const stillUnsynced = [];
        for (const entry of forms) {
          try {
            await db.collection("autoInfo").add({
              ...entry,
              syncedAt: firebase.firestore.FieldValue.serverTimestamp()
            });
          } catch {
            stillUnsynced.push(entry);
          }
        }
        localStorage.setItem("unsyncedForms", JSON.stringify(stillUnsynced));
      }
      window.addEventListener("load",   syncOfflineData);
      window.addEventListener("online", syncOfflineData);

      // FORM HANDLING
      const form     = document.getElementById("AutoInfoForm");
      const clearBtn = document.getElementById("clearButton");

      clearBtn.addEventListener("click", (e) => {
        e.preventDefault();
        form.querySelectorAll("input").forEach(i => (i.value = ""));
      });

      document.getElementById("AutoInfoForm").addEventListener("keypress", (event) => {
      if (event.key === "Enter") { // if enter is pressed
        event.preventDefault();
        document.getElementById("submit").click(); // trigger submit
      }
      });

      form.addEventListener("submit", async (e) => {
        e.preventDefault();
        const userResponse = confirm("Are you sure you want to submit?");
        if (userResponse) {
          const data = {};
          new FormData(form).forEach((v, k) => (data[k] = v));
          data.createdAt = new Date().toISOString();

          // save locally
          const buf = JSON.parse(localStorage.getItem("unsyncedForms") || "[]");
          buf.push(data);
          localStorage.setItem("unsyncedForms", JSON.stringify(buf));
          // alert("Saved locally—trying to sync…");

          if (navigator.onLine) await syncOfflineData();
          else alert("Offline; will sync when you’re back online.");

          form.reset();
        } else {
          alert("Submission canceled.");
        }
      });

    });
  </script>
</html>